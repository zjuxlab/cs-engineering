---
title: 数据库分类选型
slug: 数据库分类选型
sidebar_position: 4
---


# 数据库分类选型

Author: 陈岩,Vista

# SQL vs NoSQL

## 何为 SQL DB

SQL DBMS，是一种以数据表为基本组织形式的数据库

![](/assets/Blr5w6M2UhR3Frb4dVDcjsdGnGb-board.png)

其特征有：

- 采用SQL语言进行交互
- 数据表具有确定的列结构
- 方便进行Join等复杂查询

## 何为NoSQL

本意为 Not Only SQL ，但实际上，也就是不兼容SQL语法和数据结构的数据库统称

其特征有：

- 针对某种场合特化
    - 键值对存储（字典）
        - 典型的有 Redis
    - 嵌套和可变结构（文档）
        - 典型的有 MongoDB
    - 对象复杂关系（图）
        - 典型的有 neo4j
    - 针对时序数据操作（流 / 写入优化）
    - 针对海量数据的维护（大数据优化）

- 不支持SQL查询，采用自定义交互语言（较常用的是Json）
- 在一方面非常方便，但不如SQL通用，实战资料较少

# 如何选型

## 业务数据

在后端常规业务需求中，数据还是以格式相近的多条出现的，因此主要考虑SQL与Mongo；

SQL包括的多款常见DB，常用的是Mysql和Postgres，此外临时存储（如微信的聊天记录）常用SQLite

- 数据有确定的、平铺的列结构：适合采用SQL
    - 更方便、高效地进行聚合查询（计数、求和、外键Join等）
    - 当然也可以采用Mongo，Mongo甚至简单查询的速度更快
    - 更加常用，资料更多，类库更多

- 数据有复杂的对象、数组嵌套：适合采用Mongo
    - 当然也可以采用SQL，但是需要把嵌套对象展开，把数组根据第四范式分表；存储、搜索、查询负担都会更大
    - 高度自定义的基于管线的查改操作

SQL和Mongo都有的功能

- Json存储和查询（没想到吧，SQL其实也有Json规范，只是还没有广泛使用，DB和库都支持的不够完善）
- 事务和隔离（但是不同DB实现的方式和隔离级别不一样）
- 复杂聚合操作（Mongo比SQL写起来复杂）
- 分布式存储（高并发和容灾）

【实例】

1. 学生/图书 管理系统：
    - 数据结构固定
    - 字段平铺且固定
    - 需要多表频繁Join
    - 适合SQL的数据表

2. 游戏后台数据：
    1. 多种变长字段（例如消费记录、上线记录）
    2. 多种嵌套字段（社交账号绑定、个人主页信息等）
    3. 大部分功能仅在一个文档（一个玩家）级别进行数据处理
    4. Mongo的文档查询和修改开销更小

## 缓存数据

当需要可持久化、带数据共享、或组织形式复杂的缓存数据时，可以采用Redis的方式

比起内存中的LRU Hashmap，Redis在持久化、安全性等方面有优势

## 文件存储

OSS（对象存储）

对于零散的大量文件提供高性能、高可靠的写入、读取服务

结构类似于文件夹

不算数据库，只能存取数据的服务，没有复杂查询功能

常见的本地服务有Minio

